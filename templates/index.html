<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Road Maintenance Optimizer - Genetic Algorithm</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css', v=12) }}">
</head>
<body>

<div class="container">
  <div class="header">
    <h1>ğŸ›£ï¸ Road Maintenance Optimizer</h1>
    <p>Genetic Algorithm untuk Optimasi Pemeliharaan Jalan</p>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button type="button" class="tab-button active" onclick="showTab('input')">ğŸ“š Data Jurnal</button>
    <button type="button" class="tab-button" onclick="showTab('parameters')">âš™ï¸ Parameter Algoritma</button>
    {% if result %}
    <button type="button" class="tab-button" onclick="showTab('results')">ğŸ† Hasil Optimasi</button>
    {% endif %}
  </div>

  <form id="ga-form" method="post" action="/run">

    <!-- TAB 1: INPUT DATA -->
    <div id="tab-input" class="tab-content active">

      <!-- DATA JURNAL INFO CARD -->
      <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);">
        <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
          <div style="font-size: 4em;">ğŸ“š</div>
          <div>
            <h2 style="margin: 0; color: white; font-size: 1.8em; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);">
              Data Studi Kasus Jurnal
            </h2>
            <p style="margin: 10px 0 0 0; font-size: 1.1em; opacity: 0.95;">
              <em>Applied Sciences 2025, Volume 15, Issue 10094</em>
            </p>
          </div>
        </div>
        
        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; backdrop-filter: blur(10px);">
          <h3 style="color: white; margin-top: 0; font-size: 1.3em;">ğŸ“Š Ringkasan Dataset</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px;">
              <div style="font-size: 0.9em; opacity: 0.9;">ğŸš§ Total Kerusakan</div>
              <div style="font-size: 2em; font-weight: 700; margin-top: 5px;">20</div>
              <div style="font-size: 0.85em; opacity: 0.85; margin-top: 5px;">Dari Table 2</div>
            </div>
            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px;">
              <div style="font-size: 0.9em; opacity: 0.9;">ğŸ’° Opsi Biaya</div>
              <div style="font-size: 2em; font-weight: 700; margin-top: 5px;">16</div>
              <div style="font-size: 0.85em; opacity: 0.85; margin-top: 5px;">Dari Table 4</div>
            </div>
            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px;">
              <div style="font-size: 0.9em; opacity: 0.9;">ğŸ“ Rentang Lokasi</div>
              <div style="font-size: 2em; font-weight: 700; margin-top: 5px;">0-12 KM</div>
              <div style="font-size: 0.85em; opacity: 0.85; margin-top: 5px;">12000 meter jalan</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
          <p style="margin: 0; font-size: 1.05em; line-height: 1.6;">
            âœ… Dataset diambil dari jurnal tervalidasi<br>
            âœ… GA akan otomatis memilih segmen optimal dari Table 4<br>
            âœ… Hasil akan dibandingkan dengan Table 6 (hasil peneliti) ğŸ“Š
          </p>
        </div>
      </div>

      <!-- TABEL DISTRESS -->
      <div class="card">
        <h2>ğŸš§ Data Kerusakan Jalan (Distress) - Table 2</h2>
        <div style="overflow-x: auto;">
          <table style="width: 100%; border-collapse: collapse;">
            <thead>
              <tr style="background: #667eea; color: white;">
                <th style="padding: 12px; text-align: left;">ID</th>
                <th style="padding: 12px; text-align: left;">Lokasi (KM + m)</th>
                <th style="padding: 12px; text-align: right;">Lokasi Total (m)</th>
                <th style="padding: 12px; text-align: right;">Deduction</th>
                <th style="padding: 12px; text-align: right;">Biaya Local (USD)</th>
              </tr>
            </thead>
            <tbody>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D1</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 3 + 772m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">3,772</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">22.70</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$454</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D2</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 10 + 529m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">10,529</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">10.50</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$210</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D3</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 9 + 728m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">9,728</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">28.35</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$567</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D4</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 1 + 324m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">1,324</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">9.30</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$186</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D5</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 7 + 212m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">7,212</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">21.75</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$435</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D6</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 3 + 595m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">3,595</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">8.15</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$163</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D7</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 7 + 595m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">7,595</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">13.00</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$260</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D8</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 1 + 107m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">1,107</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">29.45</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$589</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D9</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 10 + 692m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">10,692</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">31.75</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$635</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D10</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 5 + 349m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">5,349</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">18.30</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$366</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D11</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 11 + 516m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">11,516</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">20.50</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$410</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D12</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 3 + 675m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">3,675</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">19.25</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$385</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D13</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 2 + 648m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">2,648</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">25.85</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$517</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D14</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 6 + 479m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">6,479</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">10.50</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$210</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D15</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 8 + 295m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">8,295</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">18.35</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$367</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D16</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 6 + 918m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">6,918</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">9.95</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$199</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D17</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 11 + 183m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">11,183</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">29.70</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$594</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D18</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 5 + 903m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">5,903</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">21.80</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$436</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D19</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 9 + 296m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">9,296</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">28.20</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$564</td></tr>
              <tr><td style="padding: 10px; border-bottom: 1px solid #eee;">D20</td><td style="padding: 10px; border-bottom: 1px solid #eee;">KM 10 + 132m</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">10,132</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">10.00</td><td style="padding: 10px; border-bottom: 1px solid #eee; text-align: right;">$200</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- TABEL BIAYA RESURFACING -->
      <div class="card">
        <h2>ğŸ’° Opsi Biaya Resurfacing - Table 4</h2>
        <p style="margin-bottom: 20px; color: #666;">
          GA akan memilih kombinasi panjang segmen dari tabel ini untuk menghasilkan solusi optimal.
          Segmen bisa ditempatkan di berbagai posisi sepanjang jalan (0-12000 meter).
        </p>
        <div style="overflow-x: auto;">
          <table style="width: 100%; border-collapse: collapse;">
            <thead>
              <tr style="background: #764ba2; color: white;">
                <th style="padding: 12px; text-align: center;">Panjang Segmen (m)</th>
                <th style="padding: 12px; text-align: center;">Biaya Resurfacing (USD)</th>
                <th style="padding: 12px; text-align: center;">Biaya per Meter</th>
              </tr>
            </thead>
            <tbody>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">5</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$6,400</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$1,280/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">10</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$7,700</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$770/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">15</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$9,033</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$602/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">20</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$10,267</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$513/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">25</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$11,333</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$453/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">30</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$12,567</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$419/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">35</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$15,733</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$449/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">40</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$17,000</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$425/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">45</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$18,233</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$405/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">50</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$19,467</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$389/m</td></tr>
              <tr style="background: #f0f7ff;"><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">100</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">$31,000</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #4a6cf7; font-weight: 600;">$310/m â­</td></tr>
              <tr style="background: #f0f7ff;"><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">150</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">$43,333</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #4a6cf7; font-weight: 600;">$289/m â­</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">200</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$56,000</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$280/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">250</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$68,000</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$272/m</td></tr>
              <tr><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: 600;">300</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">$80,333</td><td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center; color: #666;">$268/m</td></tr>
              <tr style="background: #f0f7ff;"><td style="padding: 12px; text-align: center; font-weight: 600;">350</td><td style="padding: 12px; text-align: center; font-weight: 600;">$93,333</td><td style="padding: 12px; text-align: center; color: #4a6cf7; font-weight: 600;">$267/m â­</td></tr>
            </tbody>
          </table>
        </div>
        <div style="margin-top: 15px; padding: 15px; background: #f0f7ff; border-left: 4px solid #4a6cf7; border-radius: 4px;">
          <p style="margin: 0; color: #333;">
            <strong>ğŸ’¡ Insight:</strong> Segmen yang lebih panjang umumnya lebih ekonomis per meter (economy of scale).
            GA akan mencari kombinasi optimal antara efisiensi biaya dan coverage kerusakan.
          </p>
        </div>
      </div>

      <input type="hidden" name="use_journal" value="on">

    </div> <!-- END TAB INPUT -->

    <!-- TAB 2: PARAMETERS -->
    <div id="tab-parameters" class="tab-content">
      <div class="card">
        <h2>âš™ï¸ Parameter Algoritma Genetika</h2>
        <p style="color: #666; margin-bottom: 25px;">
          ğŸ’¡ <strong>Nilai default sudah optimal!</strong> Ubah hanya jika Anda ingin bereksperimen dengan hasil yang berbeda.
        </p>

        <div class="form-grid">
          <div class="form-group">
            <label>
              ğŸ’° Budget (USD)
              <span class="param-hint">Anggaran maksimal untuk resurfacing</span>
            </label>
            <input type="number" name="budget" value="{{ params.budget if params else '150000' }}" min="50000" step="10000">
            <small style="color: #888; display: block; margin-top: 5px;">
              ğŸ“Œ Optimal: $150,000 | Min: $50,000 | Semakin besar budget, semakin banyak kerusakan yang bisa diperbaiki
            </small>
          </div>

          <div class="form-group">
            <label>
              ğŸ‘¥ Ukuran Populasi
              <span class="param-hint">Jumlah solusi kandidat per generasi</span>
            </label>
            <input type="number" name="pop_size" value="{{ params.pop_size if params else '50' }}" min="20" max="200" step="10">
            <small style="color: #888; display: block; margin-top: 5px;">
              ğŸ“Œ Optimal: 50 | Rentang: 20-200 | Lebih besar = hasil lebih baik tapi lebih lambat
            </small>
          </div>

          <div class="form-group">
            <label>
              ğŸ”„ Jumlah Generasi
              <span class="param-hint">Iterasi evolusi algoritma</span>
            </label>
            <input type="number" name="generations" value="{{ params.generations if params else '50' }}" min="20" max="200" step="10">
            <small style="color: #888; display: block; margin-top: 5px;">
              ğŸ“Œ Optimal: 50 | Rentang: 20-200 | Lebih banyak = konvergensi lebih baik tapi lebih lambat
            </small>
          </div>

          <div class="form-group">
            <label>
              ğŸ§¬ Crossover Rate
              <span class="param-hint">Probabilitas perkawinan silang (0-1)</span>
            </label>
            <input type="number" name="crossover_rate" value="{{ params.crossover_rate if params else '0.8' }}" step="0.05" min="0.5" max="1.0">
            <small style="color: #888; display: block; margin-top: 5px;">
              ğŸ“Œ Optimal: 0.8 | Rentang: 0.5-1.0 | Tinggi = eksplorasi kombinasi lebih agresif
            </small>
          </div>

          <div class="form-group">
            <label>
              ğŸ² Mutation Rate
              <span class="param-hint">Probabilitas mutasi gen (0-1)</span>
            </label>
            <input type="number" name="mutation_rate" value="{{ params.mutation_rate if params else '0.15' }}" step="0.01" min="0.05" max="0.3">
            <small style="color: #888; display: block; margin-top: 5px;">
              ğŸ“Œ Optimal: 0.15 | Rentang: 0.05-0.3 | Tinggi = variasi lebih besar, hindari local optimum
            </small>
          </div>

          <div class="form-group" style="grid-column: 1 / -1;">
            <div style="background: #f0f7ff; padding: 15px; border-radius: 8px; border-left: 4px solid #4a6cf7;">
              <strong style="color: #333;">ğŸ’¡ Tips Optimasi:</strong>
              <ul style="margin: 10px 0 0 20px; color: #666;">
                <li><strong>Hasil terbaik:</strong> Pop=50, Gen=50, Cross=0.8, Mut=0.15 (â±ï¸ ~5 detik)</li>
                <li><strong>Cepat:</strong> Pop=30, Gen=30 (â±ï¸ ~2 detik, hasil cukup baik)</li>
                <li><strong>Maksimal:</strong> Pop=100, Gen=100 (â±ï¸ ~20 detik, hasil optimal)</li>
                <li><strong>Budget rendah:</strong> Naikkan mutation rate ke 0.2 untuk eksplorasi lebih luas</li>
              </ul>
            </div>
          </div>
        </div>

        <button type="submit" id="runButton" style="margin-top: 20px;">ğŸš€ Jalankan Optimasi GA</button>
      </div>
    </div>

    <!-- TAB 3: RESULTS -->
    {% if result %}
    <div id="tab-results" class="tab-content">

      <!-- SUMMARY -->
      <div class="summary-card">
        <div class="summary-header-line">
          <div class="summary-icon">ğŸ“Š</div>
          <div class="summary-title">Ringkasan Hasil Optimasi</div>
        </div>

        <div class="summary-items">
          <div class="summary-item">
            <div class="summary-item-label">Best Fitness</div>
            <div class="summary-item-value">{{ result.best_fitness }}</div>
          </div>

          <div class="summary-item">
            <div class="summary-item-label">Total Biaya</div>
            <div class="summary-item-value">${{ "{:,.0f}".format(result.total_cost) }}</div>
          </div>

          <div class="summary-item">
            <div class="summary-item-label">Total Benefit</div>
            <div class="summary-item-value">{{ result.total_benefit }}</div>
          </div>

          <div class="summary-item">
            <div class="summary-item-label">Budget</div>
            <div class="summary-item-value">${{ "{:,.0f}".format(result.budget) }}</div>
          </div>

          <div class="summary-item">
            <div class="summary-item-label">Budget Used</div>
            <div class="summary-item-value">
              {% set used = (result.total_cost / result.budget * 100) | round(2) %}
              {{ used }}%
            </div>
          </div>
        </div>
      </div>

      <!-- METHOD BREAKDOWN -->
      <div class="card">
        <h2>ğŸ”§ Breakdown Metode Perbaikan</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; text-align: center;">
            <div style="font-size: 2.5em; font-weight: bold;">{{ result.resurfacing_count }}</div>
            <div style="font-size: 1.1em; opacity: 0.9;">Resurfacing</div>
            <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">${{ "{:,.0f}".format(result.resurfacing_cost) }}</div>
          </div>
          <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 12px; text-align: center;">
            <div style="font-size: 2.5em; font-weight: bold;">{{ result.local_repair_count }}</div>
            <div style="font-size: 1.1em; opacity: 0.9;">Local Repair</div>
            <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">${{ "{:,.0f}".format(result.local_repair_cost) }}</div>
          </div>
          <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 12px; text-align: center;">
            <div style="font-size: 2.5em; font-weight: bold;">20</div>
            <div style="font-size: 1.1em; opacity: 0.9;">Total Diperbaiki</div>
            <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">100% Coverage</div>
          </div>
        </div>
        <div style="background: #f0f7ff; padding: 15px; border-radius: 8px; border-left: 4px solid #4a6cf7;">
          <p style="margin: 0; color: #333;">
            <strong>ğŸ’¡ Strategi GA:</strong> Algoritma memilih resurfacing untuk area dengan banyak kerusakan berdekatan (lebih ekonomis), 
            dan local repair untuk kerusakan individual yang tersebar (lebih efisien untuk kasus spesifik).
          </p>
        </div>
      </div>

      <!-- SEGMENTS TABLE -->
      <div class="card">
        <h2>ğŸ”§ Segmen Terpilih</h2>
        {% if result.chosen_segments %}
        <table>
          <tr>
            <th>ID</th>
            <th>Start</th>
            <th>End</th>
            <th>Panjang</th>
            <th>Biaya</th>
            <th>% Panjang (asumsi 10 km)</th>
          </tr>
          {% for s in result.chosen_segments %}
          <tr>
            <td>{{ s.id }}</td>
            <td>{{ s.start_m }}</td>
            <td>{{ s.end_m }}</td>
            <td>{{ s.length }} m</td>
            <td>${{ "{:,.0f}".format(s.cost) }}</td>
            <td>
              {% set pct = (s.length / 10000 * 100) | round(2) %}
              {{ pct }}%
            </td>
          </tr>
          {% endfor %}
        </table>
        {% else %}
        <p>Tidak ada segmen yang dipilih.</p>
        {% endif %}
      </div>

      <!-- DISTRESS STATUS TABLE -->
      <div class="card">
        <h2>ğŸš§ Status Kerusakan & Metode Perbaikan</h2>
        <table>
          <tr>
            <th>ID</th>
            <th>Lokasi (m)</th>
            <th>Deduction</th>
            <th>Biaya Local</th>
            <th>Status</th>
            <th>Metode</th>
          </tr>
          {% for d in result.distress_status %}
          <tr>
            <td><strong>{{ d.id }}</strong></td>
            <td>{{ d.location_m }}</td>
            <td>{{ d.deduction }}</td>
            <td>${{ "{:,.0f}".format(d.cost_local) }}</td>
            <td>
              {% if d.repaired %}
                <span style="color: #22c55e; font-weight: bold;">âœ” Repaired</span>
              {% else %}
                <span style="color: #ef4444; font-weight: bold;">âœ˜ Not Fixed</span>
              {% endif %}
            </td>
            <td>
              {% if d.method == "Resurfacing" %}
                <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.9em; font-weight: 500;">
                  ğŸ›£ï¸ Resurfacing
                </span>
              {% elif d.method == "Local Repair" %}
                <span style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.9em; font-weight: 500;">
                  ğŸ”§ Local Repair
                </span>
              {% else %}
                <span style="color: #999;">-</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </table>
      </div>

    </div>
    {% endif %}

  </form>
</div>

<script src="{{ url_for('static', filename='js/main.js', v=11) }}"></script>
</body>
</html>
